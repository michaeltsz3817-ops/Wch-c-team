<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç£ä»” C éšŠåˆ¶æœé è¨‚</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; -webkit-tap-highlight-color: transparent; }
        .btn-press:active { transform: scale(0.95); transition: transform 0.1s; }
        .scroll-hide::-webkit-scrollbar { display: none; }
        .category-scroll { -webkit-overflow-scrolling: touch; }
    </style>
</head>
<body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // ==========================================
        // ğŸ”§ è¨­å®šå€åŸŸ (å·²æ›´æ–°ç‚ºæœ€æ–° Link)
        // ==========================================
        const FORM_URL = "https://docs.google.com/forms/d/e/1FAIpQLSemKuLmfrqvXLTqQT2bK7mScp04kQ5AOfLUDKnZsNyLUDrRhA/formResponse";
        const IDS = {
            NAME: "entry.1386941444",   // å§“åUI
            ITEM: "entry.1748307909",   // åˆ¶æœæ¬¾å¼
            SIZE: "entry.584139612"     // å°ºç¢¼
        };

        // ==========================================
        // ğŸš’ åˆ¶æœæ¸…å–®
        // ==========================================
        const PRODUCTS = [
            // --- é‹é¡ ---
            { category: 'é‹é¡', id: '208', name: 'è·‘æ­¥é‹ (Item 208)', desc: 'Shoe Running', icon: 'fa-running', sizes: ['7', '7.5', '8', '8.5', '9', '9.5', '10'] },
            { category: 'é‹é¡', id: '207', name: 'ç™½å¸†å¸ƒé‹ (Item 207)', desc: 'White Canvas', icon: 'fa-shoe-prints', sizes: ['40', '41', '42', '43', '44'] },
            { category: 'é‹é¡', id: '216', name: 'é»‘çš®é‹ (Item 216)', desc: 'Black Rubber O/R', icon: 'fa-shoe-prints', sizes: ['8.5', '9', '9.5'] },
            { category: 'é‹é¡', id: '32', name: 'å®‰å…¨è¸è¶³é‹ (Item 32)', desc: 'Safety Ankle', icon: 'fa-boot', sizes: ['7', '7.5', '8', '8.5', '9', '9.5', '10'] },
            { category: 'é‹é¡', id: '7', name: 'æ¶ˆé˜²è† é´ (Item 7)', desc: 'Firetred', icon: 'fa-boot', sizes: ['7', '8', '9', '10', '11'] },

            // --- ä¸Šèº« ---
            { category: 'ä¸Šèº«', id: '256', name: 'å·¥ä½œæ±—è¡£ (Item 256)', desc: 'Working T-shirt', icon: 'fa-tshirt', sizes: ['38/S', '40/M', '42/L', '44/XL', '46/XXL', '48/XXXL'] },
            { category: 'ä¸Šèº«', id: '215', name: 'ä¸‰ç´šè—é•·è¢–æ¤è¡« (Item 215)', desc: 'Officer & O/R', icon: 'fa-shirt', sizes: ['15/32', '15/33', '15/34', '15.5/34', '16/34', '16.5/34', '17/34'] },
            { category: 'ä¸Šèº«', id: '220', name: 'ä¸‰ç´šè—çŸ­è¢–æ¤è¡« (Item 220)', desc: 'S/S for O/R', icon: 'fa-shirt', sizes: ['15.5/40', '15.5/42', '16/40', '16/42', '16.5/42', '16/44'] },
            
            // --- ä¸‹èº« ---
            { category: 'ä¸‹èº«', id: '258', name: 'è—æ–œé•·è¤² (Item 258)', desc: 'Trousers Blue', icon: 'fa-user', sizes: ['30/42', '32/40', '32/41', '32/42', '34/40', '34/41', '34/42', '36/41', '36/42', '38/41', '38/42'] },
            { category: 'ä¸‹èº«', id: '247', name: 'é‹å‹•çŸ­è¤² (Item 247)', desc: 'Shorts Blue P.T.', icon: 'fa-shorts', sizes: ['L', 'XL', 'XXL', 'XXXL'] },

            // --- é‹å‹•æœ ---
            { category: 'é‹å‹•æœ', id: '275', name: 'é‹å‹•èƒŒå¿ƒ (Item 275)', desc: 'Vest Blue P.T.', icon: 'fa-vest', sizes: ['40', '42', '44', '46', '48'] },
            { category: 'é‹å‹•æœ', id: '245', name: 'é•·è¢–é‹å‹•è¡« (Item 245)', desc: 'Shirt P.T. Winter', icon: 'fa-tshirt', sizes: ['42', '44', '46', '48', '50'] },

            // --- é…ä»¶/è£å‚™ ---
            { category: 'é…ä»¶', id: '28', name: 'å€‹äººè£å‚™è¢‹ [è—è‰²]', desc: 'Item 28', icon: 'fa-shopping-bag', sizes: ['ä¸€å€‹'] },
            { category: 'é…ä»¶', id: '10', name: 'ç¶ è‰²å·¥å…·è¢‹', desc: 'Item 10', icon: 'fa-toolbox', sizes: ['ä¸€å€‹'] },
            { category: 'é…ä»¶', id: '88', name: 'å¸ƒè‚©ç«  (è—è‰²)', desc: 'Item 88/183/182/181', icon: 'fa-shield-alt', sizes: ['éšŠå“¡', 'è³‡æ·±éšŠå“¡', 'éšŠç›®', 'ç¸½éšŠç›®'] },
            { category: 'é…ä»¶', id: '180', name: 'é˜²æ°´è‚©ç«  (é»‘è‰²)', desc: 'Item 180/186/185/184', icon: 'fa-shield-alt', sizes: ['éšŠå“¡', 'è³‡æ·±éšŠå“¡', 'éšŠç›®', 'ç¸½éšŠç›®'] },
            { category: 'é…ä»¶', id: '30', name: 'é´¨å’€å¸½ (Item 30)', desc: 'Cap', icon: 'fa-hat-cowboy', sizes: ['M', 'L'] },
            { category: 'é…ä»¶', id: '57', name: 'é˜²çˆ†æ‰‹å¥— (Item 57)', desc: 'Fire Retardant', icon: 'fa-mitten', sizes: ['S', 'M', 'L'] },
            { category: 'é…ä»¶', id: 'glove_mt', name: 'æ”€å±±æ‰‹å¥—', desc: 'Gloves', icon: 'fa-mitten', sizes: ['M', 'L'] }
        ];

        const CATEGORIES = [...new Set(PRODUCTS.map(p => p.category))];

        function ProductCard({ product, onAdd }) {
            const [customSize, setCustomSize] = useState('');
            const handleCustomAdd = () => {
                if (customSize.trim()) { onAdd(product, customSize.trim()); setCustomSize(''); }
            };
            return (
                <div className="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                    <div className="p-4 flex items-center gap-4 bg-slate-50 border-b border-slate-100">
                        <div className="w-12 h-12 bg-white rounded-full flex items-center justify-center text-2xl text-slate-700 shadow-sm border border-slate-100"><i className={`fas ${product.icon}`}></i></div>
                        <div><h3 className="text-lg font-bold text-slate-800">{product.name}</h3><p className="text-sm text-slate-500">{product.desc}</p></div>
                    </div>
                    <div className="p-4">
                        <div className="flex flex-wrap gap-2 mb-3">
                            {product.sizes.map(size => (
                                <button key={size} onClick={() => onAdd(product, size)} className="px-4 py-2.5 bg-white border border-slate-200 rounded-lg text-lg font-bold text-slate-600 active:bg-red-600 active:text-white active:border-red-600 transition-colors btn-press flex-grow text-center min-w-[3rem]">{size}</button>
                            ))}
                        </div>
                        <div className="relative flex items-center mt-2">
                            <div className="absolute left-3 text-slate-400"><i className="fas fa-pen"></i></div>
                            <input type="text" value={customSize} onChange={(e) => setCustomSize(e.target.value)} placeholder="è¼¸å…¥å…¶ä»–å°ºç¢¼..." className="w-full bg-slate-50 border border-slate-200 rounded-lg py-3 pl-10 pr-20 text-base outline-none focus:border-red-500 transition-colors" />
                            {customSize && <button onClick={handleCustomAdd} className="absolute right-1 top-1 bottom-1 bg-red-600 text-white px-4 rounded-md text-sm font-bold shadow-sm btn-press">åŠ å…¥</button>}
                        </div>
                    </div>
                </div>
            );
        }

        function App() {
            const [cart, setCart] = useState([]);
            const [view, setView] = useState('home'); 
            const [userInfo, setUserInfo] = useState('');
            const [isSubmitting, setIsSubmitting] = useState(false);
            const [activeCategory, setActiveCategory] = useState('é‹é¡');
            const [progress, setProgress] = useState({ current: 0, total: 0 });

            useEffect(() => {
                const saved = localStorage.getItem('c_team_user_name');
                if (saved) setUserInfo(saved);
            }, []);

            const addToCart = (product, size) => {
                setCart(prev => [...prev, { cartId: Date.now(), name: product.name, size: size, icon: product.icon }]);
                if (navigator.vibrate) navigator.vibrate(50);
            };
            const removeFromCart = (id) => setCart(cart.filter(c => c.cartId !== id));

            // --- ç©©å®šå‚³é€é‚è¼¯ (é€å€‹å‚³ + å»¶é²) ---
            const handleSubmit = async () => {
                if (!userInfo || cart.length === 0) return;
                setIsSubmitting(true);
                setProgress({ current: 0, total: cart.length });

                for (let i = 0; i < cart.length; i++) {
                    const item = cart[i];
                    try {
                        const formData = new FormData();
                        formData.append(IDS.NAME, userInfo);
                        formData.append(IDS.ITEM, item.name);
                        formData.append(IDS.SIZE, item.size);
                        
                        // ç™¼é€è«‹æ±‚
                        await fetch(FORM_URL, { method: 'POST', body: formData, mode: 'no-cors' });
                        
                        // æ›´æ–°é€²åº¦
                        setProgress({ current: i + 1, total: cart.length });
                        
                        // ç­‰å¾… 1 ç§’ (é¿å… Google Block)
                        await new Promise(r => setTimeout(r, 1000));
                        
                    } catch (e) {
                        console.error("Error", e);
                    }
                }

                setIsSubmitting(false);
                setCart([]);
                localStorage.setItem('c_team_user_name', userInfo);
                setView('success');
            };

            if (view === 'success') {
                return (
                    <div className="min-h-screen bg-green-50 flex flex-col items-center justify-center p-6 text-center">
                        <div className="w-24 h-24 bg-green-100 rounded-full flex items-center justify-center mb-6 shadow-lg animate-bounce"><i className="fas fa-check text-green-600 text-5xl"></i></div>
                        <h1 className="text-3xl font-bold text-slate-800 mb-2">ææ‚ï¼</h1>
                        <p className="text-lg text-slate-600 mb-10 font-medium"><span className="text-green-700 font-bold text-xl">{userInfo}</span> å¸«å…„<br/>ä½ å˜…åˆ¶æœå·²ç¶“å ±å’—åã€‚</p>
                        <button onClick={() => setView('home')} className="w-full py-4 bg-white border-2 border-green-600 text-green-700 font-bold rounded-xl text-lg shadow-md btn-press">å¹«å¦ä¸€ä½å¸«å…„å ±å</button>
                    </div>
                );
            }

            if (view === 'checkout') {
                return (
                    <div className="min-h-screen bg-slate-50 flex flex-col font-sans">
                        <div className="bg-red-700 text-white p-4 pt-4 pb-4 shadow-md flex items-center gap-4 sticky top-0 z-10">
                            <button onClick={() => setView('home')} className="px-4 py-2 bg-red-800 rounded-lg text-lg font-bold btn-press"><i className="fas fa-arrow-left mr-2"></i>è¿”å›</button>
                            <h1 className="text-xl font-bold">æ ¸å°è³‡æ–™</h1>
                        </div>
                        <div className="flex-1 p-4 overflow-y-auto pb-32">
                            <div className="bg-white rounded-2xl shadow-sm border border-slate-200 p-5 mb-6">
                                <h2 className="text-sm font-bold text-slate-400 uppercase tracking-wide mb-4 border-b border-slate-100 pb-2">å·²é¸åˆ¶æœ ({cart.length})</h2>
                                {cart.length === 0 ? <div className="text-center text-slate-400 py-4">æœªæ€ä»»ä½•å˜¢</div> : cart.map(item => (
                                    <div key={item.cartId} className="flex justify-between items-center py-4 border-b border-slate-100 last:border-0">
                                        <div className="flex items-center gap-4">
                                            <div className="w-10 h-10 bg-slate-100 rounded-full flex items-center justify-center text-xl text-slate-600"><i className={`fas ${item.icon}`}></i></div>
                                            <div><div className="text-lg font-bold text-slate-800">{item.name}</div><div className="text-base text-slate-500">å°ºç¢¼: <span className="font-bold text-red-600 bg-red-50 px-2 rounded">{item.size}</span></div></div>
                                        </div>
                                        <button onClick={() => removeFromCart(item.cartId)} className="w-10 h-10 flex items-center justify-center text-slate-300 hover:text-red-500 hover:bg-red-50 rounded-full transition-colors btn-press"><i className="fas fa-trash-alt"></i></button>
                                    </div>
                                ))}
                            </div>
                            <div className="bg-white rounded-2xl shadow-sm border border-slate-200 p-6">
                                <label className="block text-lg font-bold text-slate-800 mb-3 flex items-center gap-2"><i className="fas fa-user-edit text-red-600"></i> è¼¸å…¥å§“å / UIï¼š</label>
                                <input type="text" value={userInfo} onChange={e => setUserInfo(e.target.value)} placeholder="ä¾‹å¦‚: 12345 é™³å¤§æ–‡" className="w-full bg-slate-50 border-2 border-slate-200 rounded-xl p-4 text-xl font-bold outline-none focus:border-red-600 focus:bg-white transition-colors" />
                            </div>
                        </div>
                        <div className="p-4 bg-white border-t border-slate-200 fixed bottom-0 left-0 right-0 z-20 safe-area-bottom">
                            <button onClick={handleSubmit} disabled={isSubmitting || !userInfo || cart.length === 0} className={`w-full py-4 rounded-xl text-xl font-bold text-white shadow-lg btn-press flex items-center justify-center gap-3 ${isSubmitting || !userInfo || cart.length === 0 ? 'bg-slate-300' : 'bg-red-600'}`}>
                                {isSubmitting ? <><i className="fas fa-spinner fa-spin"></i> æ­£åœ¨å‚³é€ ({progress.current}/{progress.total})...</> : <><i className="fas fa-paper-plane"></i> ç¢ºèªå‚³é€</>}
                            </button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-slate-100 pb-32 font-sans">
                    <header className="bg-red-700 text-white pt-6 pb-4 px-4 shadow-lg sticky top-0 z-20">
                        <div className="flex justify-between items-center mb-4">
                            <div><h1 className="text-2xl font-extrabold tracking-tight">ç£ä»”æ¶ˆé˜²å±€ <span className="text-sm bg-white text-red-700 px-2 py-0.5 rounded ml-2 align-middle">C éšŠå°ˆå±¬</span></h1></div>
                            <div className="relative" onClick={() => cart.length > 0 && setView('checkout')}>
                                <i className="fas fa-shopping-cart text-2xl"></i>
                                {cart.length > 0 && <span className="absolute -top-2 -right-2 bg-yellow-400 text-red-800 text-xs font-bold w-5 h-5 flex items-center justify-center rounded-full border-2 border-red-700">{cart.length}</span>}
                            </div>
                        </div>
                        <div className="flex gap-2 overflow-x-auto pb-1 category-scroll scroll-hide">
                            {CATEGORIES.map(cat => (
                                <button key={cat} onClick={() => setActiveCategory(cat)} className={`whitespace-nowrap px-4 py-2 rounded-full text-sm font-bold transition-all ${activeCategory === cat ? 'bg-white text-red-700 shadow-md' : 'bg-red-800 text-red-200'}`}>{cat}</button>
                            ))}
                        </div>
                    </header>
                    <main className="px-4 py-4 space-y-4">
                        {PRODUCTS.filter(p => p.category === activeCategory).map(product => (<ProductCard key={product.id} product={product} onAdd={addToCart} />))}
                    </main>
                    {cart.length > 0 && (
                        <div className="fixed bottom-0 left-0 right-0 bg-white border-t border-slate-200 p-4 shadow-[0_-5px_20px_rgba(0,0,0,0.1)] z-30 safe-area-bottom">
                            <div className="flex items-center gap-4">
                                <div className="flex-1 pl-2"><div className="text-xs text-slate-500 font-bold uppercase">å·²æ€é¸</div><div className="text-2xl font-bold text-red-600">{cart.length} <span className="text-sm text-slate-800 font-medium">ä»¶</span></div></div>
                                <button onClick={() => setView('checkout')} className="bg-red-600 text-white text-lg font-bold px-6 py-3 rounded-xl shadow-lg btn-press flex items-center gap-2">å»å¡«å <i className="fas fa-arrow-right"></i></button>
                            </div>
                        </div>
                    )}
                </div>
            );
        }
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

